---
# tasks/main.yml - Main task file for the NetBird Ansible role

- name: Include account settings tasks
  ansible.builtin.include_tasks: account.yml
  when: netbird_account_settings | length > 0
  tags:
    - netbird
    - netbird-account

- name: Include user management tasks
  ansible.builtin.include_tasks: users.yml
  when: netbird_users | length > 0 or netbird_service_users | length > 0
  tags:
    - netbird
    - netbird-users

- name: Include group management tasks
  ansible.builtin.include_tasks: groups.yml
  when: netbird_groups | length > 0
  tags:
    - netbird
    - netbird-groups

- name: Include setup key management tasks
  ansible.builtin.include_tasks: setup_keys.yml
  when: netbird_setup_keys | length > 0
  tags:
    - netbird
    - netbird-setup-keys

- name: Include policy management tasks
  ansible.builtin.include_tasks: policies.yml
  when: netbird_policies | length > 0
  tags:
    - netbird
    - netbird-policies

- name: Include network management tasks
  ansible.builtin.include_tasks: networks.yml
  when: netbird_networks | length > 0
  tags:
    - netbird
    - netbird-networks

- name: Include route management tasks
  ansible.builtin.include_tasks: routes.yml
  when: netbird_routes | length > 0
  tags:
    - netbird
    - netbird-routes

- name: Include DNS management tasks
  ansible.builtin.include_tasks: dns.yml
  when: netbird_dns_nameserver_groups | length > 0 or netbird_dns_disabled_management_groups | length > 0
  tags:
    - netbird
    - netbird-dns

- name: Include posture check management tasks
  ansible.builtin.include_tasks: posture_checks.yml
  when: netbird_posture_checks | length > 0
  tags:
    - netbird
    - netbird-posture-checks

